<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>Blue Chat V7</title>
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <style>
        body { margin: 0; font-family: sans-serif; overflow: hidden; color: white; transition: 2s; background: #000; }
        .day-bg { background: linear-gradient(rgba(0,0,0,0.2),rgba(0,0,0,0.2)), url('https://images.unsplash.com/photo-1470770841072-f978cf4d019e?auto=format&fit=crop&w=1920&q=80'); background-size: cover; }
        .night-bg { background: linear-gradient(rgba(0,0,0,0.5),rgba(0,0,0,0.5)), url('https://images.unsplash.com/photo-1516339901600-2e1a62dc0c45?auto=format&fit=crop&w=1920&q=80'); background-size: cover; }
        .hidden { display: none !important; }
        .full { height: 100vh; display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center; }
        .glass { background: rgba(0,0,0,0.8); backdrop-filter: blur(10px); padding: 30px; border-radius: 20px; width: 350px; }
        .btn-main { width: 100%; padding: 15px; margin: 10px 0; border-radius: 50px; border: none; font-weight: bold; cursor: pointer; }
        .btn-blue { background: #0078d4; color: white; }
        .btn-green { background: #0f9d58; color: white; }
        #video-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); width: 100%; height: 100%; padding: 10px; box-sizing: border-box; background: #202124; }
        video { width: 100%; height: 100%; object-fit: cover; border-radius: 10px; }
        .sidebar { position: fixed; right: -350px; top: 0; width: 320px; height: 100%; background: white; color: black; transition: 0.3s; z-index: 200; padding: 20px; box-sizing: border-box; }
        .sidebar.open { right: 0; }
    </style>
</head>
<body id="body-bg">
    <div id="screen-init" class="full"> <button class="btn-main btn-blue" style="width:200px;" onclick="initApp()">Blue Chat èµ·å‹•</button> </div>
    <div id="screen-title" class="full hidden"> <h1 style="font-size:60px;">Blue Chat</h1> <button class="btn-main" style="width:200px;" onclick="startCaptcha()">ã‚¹ã‚¿ãƒ¼ãƒˆ</button> </div>
    <div id="screen-captcha" class="full hidden"> <div class="glass"> <h2>ğŸ¤– èªè¨¼</h2> <div id="kuku-q" style="font-size:30px; margin:20px;"></div> <input type="number" id="kuku-a" placeholder="ç­”ãˆ"> <button class="btn-main btn-blue" onclick="checkCaptcha()">èªè¨¼</button> </div> </div>
    
    <div id="screen-choice" class="full hidden">
        <div class="glass">
            <h2>ãƒ¢ãƒ¼ãƒ‰é¸æŠ</h2>
            <button class="btn-main btn-blue" onclick="show('screen-lobby')">é€šè©±</button>
            <button class="btn-main btn-green" onclick="window.location.href='https://blue-chat-message-edition-mresn8mmey.edgeone.dev/'">ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸</button>
        </div>
    </div>

    <div id="screen-lobby" class="full hidden">
        <div class="glass">
            <input type="text" id="user-nick" placeholder="ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ã‚’å…¥åŠ›">
            <hr>
            <input type="text" id="join-id" placeholder="ID (6æ–‡å­—)">
            <button class="btn-main btn-blue" onclick="requestJoin()">å‚åŠ ãƒªã‚¯ã‚¨ã‚¹ãƒˆ</button>
            <button class="btn-main btn-green" onclick="createRoom()">æ–°è¦ä½œæˆ</button>
        </div>
    </div>

    <div id="screen-wait" class="full hidden"> <div class="glass"> <h2>æ‰¿èªå¾…ã¡...</h2> </div> </div>
    <div id="screen-setup" class="full hidden"> <video id="setup-video" autoplay muted style="width:300px; border-radius:10px;"></video> <button class="btn-main btn-green" style="width:200px;" onclick="enterCall()">é€šè©±ã‚’é–‹å§‹</button> </div>

    <div id="screen-call" class="hidden" style="height:100vh;">
        <div id="video-grid"></div>
        <div style="position:absolute; bottom:20px; left:50%; transform:translateX(-50%); display:flex; gap:10px;">
            <button class="btn-main btn-blue" style="width:60px;" onclick="toggleSide('chat')">ğŸ’¬</button>
            <button class="btn-main" style="width:60px; background:red; color:white;" onclick="location.reload()">ğŸ“</button>
        </div>
        <div id="side-chat" class="sidebar">
            <h3>ãƒãƒ£ãƒƒãƒˆ</h3>
            <div id="chat-logs" style="height:70vh; overflow-y:auto; border:1px solid #ddd; margin-bottom:10px; padding:5px;"></div>
            <div style="display:flex; gap:5px;">
                <input type="text" id="chat-in" style="flex:1; padding:10px;" placeholder="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸...">
                <button class="btn-blue" style="padding:10px;" onclick="sendChat()">é€ä¿¡</button>
            </div>
        </div>
    </div>
    <script src="client.js"></script>
</body>
</html>
